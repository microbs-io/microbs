apiVersion: skaffold/v2beta27
kind: Config
build:
  tagPolicy:
    customTemplate:
      template: "{{.GIT_COMMIT}}"
      components:
      - name: GIT_COMMIT
        gitCommit: {}


####  Main  ####################################################################

profiles:
- name: main
  build:
    artifacts:
    - image: microbs-filebeat
      context: ./cli/src/plugins/obs/elastic_cloud/services/filebeat
    - image: microbs-heartbeat
      context: ./cli/src/plugins/obs/elastic_cloud/services/heartbeat
    - image: microbs-metricbeat
      context: ./cli/src/plugins/obs/elastic_cloud/services/metricbeat
    - image: microbs-otel-collector
      context: ./cli/src/plugins/obs/elastic_cloud/services/otel-collector
  deploy:
    kubectl:
      manifests:
      - ./cli/src/plugins/obs/elastic_cloud/services/filebeat/k8s/*.yaml
      - ./cli/src/plugins/obs/elastic_cloud/services/heartbeat/k8s/*.yaml
      - ./cli/src/plugins/obs/elastic_cloud/services/metricbeat/k8s/*.yaml
      - ./cli/src/plugins/obs/elastic_cloud/services/otel-collector/k8s/*.yaml
